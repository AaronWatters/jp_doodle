<!DOCTYPE html>
<html>
<head>
    <title>Animation -- jp_doodle demo</title>
    <link rel="icon" type="image/png" href="images/clock.png">
    <link rel=stylesheet href="static/style.css">

    <link rel="stylesheet" href="jquery-ui-1.12.1/jquery-ui.css">
    <script src="jquery-ui-1.12.1/external/jquery/jquery.js"></script>
    <script src="jquery-ui-1.12.1/jquery-ui.js"></script>

    <link rel="stylesheet" href="codemirrorjs/codemirror.css">
    <script src="codemirrorjs/codemirror.js"></script>
    <script src="codemirrorjs/matchbrackets.js"></script>
    <script src="codemirrorjs/continuecomment.js"></script>
    <script src="codemirrorjs/comment.js"></script>
    <script src="codemirrorjs/javascript.js"></script>
    <style type="text/css">.CodeMirror {border-top: 1px solid black; border-bottom: 1px solid black;}</style>
    <script src="jp_doodle_js/canvas_2d_widget_helper.js"></script>
    <script src="jp_doodle_js/dual_canvas_helper.js"></script>
    <script src="jp_doodle_js/rectangle_collection.js"></script>
    <script src="jp_doodle_js/array_explorer.js"></script>
    <script src="jp_doodle_js/canvas_2d_vector_field.js"></script>

    <script>
        $( function() {
          $( "#discussion" ).accordion({collapsible : true, active : 'none'});
          $( "#code_text" ).accordion({collapsible : true, active : 'none'});
        } );
    </script>
</head>

<body>
<div class="top_menu">
<ul>
<li><a href="index.html">Drawing <br><img src="images/drawing.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="010_events.html">Events <br><img src="images/events.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="020_bindings.html">Bindings <br><img src="images/bindings.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="030_animation.html">Animation <br><img src="images/clock.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="040_lasso.html">Lasso <br><img src="images/lasso.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="050_rectangles.html">Rectangles <br><img src="images/rectangle.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="060_chart.html">Chart <br><img src="images/chart.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="070_images.html">Images <br><img src="images/Images.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="080_transitions.html">Transitions <br><img src="images/Transitions.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="090_frames.html">Frames <br><img src="images/Frame.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="array_explorer.html">Array explorer <br><img src="images/ArrayChooser.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="color_chooser.html">Color chooser <br><img src="images/color_chooser.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="opacity.html">Opacity Sliders <br><img src="images/opacity.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="polygon.html">Edit polygon <br><img src="images/edit_poly.png" style="background-color:#cdf" width="50px"></a></li>
<li><a href="vector_field.html">Vector Field <br><img src="images/vector_field.png" style="background-color:#cdf" width="50px"></a></li>
</ul>
</div>

<p><em>
    This is an example page for the 
    <code><a href="https://github.com/AaronWatters/jp_doodle">jp_doodle</a></em></code>
    package. <br>

    <p><b><code><a href="https://github.com/AaronWatters/jp_doodle">jp_doodle</a></em></code>
        makes implementing special purpose interactive visualizations easy.</b></p>

    Please see the Jupyter notebooks in the package for additional
    discussion and documentation. <br>

    Please use 
    <a href="https://mybinder.org/v2/gh/AaronWatters/jp_doodle/master">Binder</a>
    to easily run the Jupyter notebooks of the package.
</em></p>

<h1>Animation</h1>
<div>
    Dual canvases can be animated.  This figure includes a clock with an animated
seconds hand and a blinking light.
</div>

<div id="target_container">
    <div id="target_div"/>
</div>

<script>
    var element = $('#target_div');
    //$('<img src="http://sipi.usc.edu/database/preview/misc/4.2.03.png">').appendTo(element);
    // Attach a dual canvas associated with the element as a child of the element
// configured with width 400 and height 400.
var config = {
            width: 400,
            height: 400,
        };
element.dual_canvas_helper(config);

// Some math...
five_seconds = Math.PI / 6.0;
twelve_oclock = Math.PI / 2.0;
outer_radius = 100;
inner_radius = 80;

// Draw the clock face.
var face = element.circle({x:0, y:0, r:100, color:"#dcf", name:true});
element.circle({x:0, y:0, r:100, color:"#449", fill:false, lineWidth:10});

// Draw the numbers on the clock as unnamed texts.
for (var i=1; i<=12; i++) {
    var angle = twelve_oclock - i * five_seconds;
    element.text({
        text: ""+i, font: "20px Arial", color: "#937", align: "center",
        x: Math.cos(angle)*inner_radius, y: Math.sin(angle)*inner_radius - 7})
}

// Draw a "seconds hand" and name it so we can change it later.
var seconds_hand = element.rect({
    name: true,  // Use any available name
    x:0, y:0, w: inner_radius-15, h:5,
    color: "#937", degrees: 90});
    
// Add a background yellow dot. Note that there is no blinking dot yet.
var blinking_dot = null;
element.circle({x:100, y:100, r:12, color:"yellow"});

// Every animation frame, adjust the seconds hand using the time.
// Also add or delete a blinking dot every other second.
var animate = function () {
    var seconds = ((new Date()).getTime() * 0.001) % 60;
    var degrees = - 6 * seconds;
    // Adjust the seconds hand.
    //element.change("seconds hand", {degrees: degrees});
    seconds_hand.change({degrees: degrees})
    // every other second create or delete the blinking dot
    if ((seconds % 2) < 1) {
        if (!blinking_dot) {
            // Add the blinking dot.
            blinking_dot = element.circle({name: true, x:100, y:100, r:10, color:"red"});
        }
    } else if (blinking_dot) {
        // Remove the blinking dot.
        blinking_dot.forget();
        blinking_dot = null;
    }
    // Repeat the animation again on the next animation iteration.
    requestAnimationFrame(animate);
}
// Adjust the canvas coordinate transform to center the drawn objects on the canvas.
element.fit(null, 10);  // 10 pixel margin

// Add transitions
var bigger = false;
var transition_face = function() {
    var seconds = 10;
    if (bigger) {
        face.transition({r:100, color:"#dcf"}, seconds);
    } else {
        face.transition({r:30, color:"#fcd"}, seconds);
    }
    bigger = !bigger;
};
$("<button>transition face</button>").appendTo(element).click(transition_face);

// Adjust the canvas coordinate transform to center the drawn objects on the canvas.
element.fit(null, 10);  // 10 pixel margin

// Start the animation
animate();
</script>

<div id="code_text">
        <h3>Code</h3>
    
        <div><textarea id="code" name="code">
var element = $('#target_div');
// Attach a dual canvas associated with the element as a child of the element
// configured with width 400 and height 400.
var config = {
            width: 400,
            height: 400,
        };
element.dual_canvas_helper(config);

// Some math...
five_seconds = Math.PI / 6.0;
twelve_oclock = Math.PI / 2.0;
outer_radius = 100;
inner_radius = 80;

// Draw the clock face.
var face = element.circle({x:0, y:0, r:100, color:"#dcf", name:true});
element.circle({x:0, y:0, r:100, color:"#449", fill:false, lineWidth:10});

// Draw the numbers on the clock as unnamed texts.
for (var i=1; i<=12; i++) {
    var angle = twelve_oclock - i * five_seconds;
    element.text({
        text: ""+i, font: "20px Arial", color: "#937", align: "center",
        x: Math.cos(angle)*inner_radius, y: Math.sin(angle)*inner_radius - 7})
}

// Draw a "seconds hand" and name it so we can change it later.
var seconds_hand = element.rect({
    name: true,  // Use any available name
    x:0, y:0, w: inner_radius-15, h:5,
    color: "#937", degrees: 90});
    
// Add a background yellow dot. Note that there is no blinking dot yet.
var blinking_dot = null;
element.circle({x:100, y:100, r:12, color:"yellow"});

// Every animation frame, adjust the seconds hand using the time.
// Also add or delete a blinking dot every other second.
var animate = function () {
    var seconds = ((new Date()).getTime() * 0.001) % 60;
    var degrees = - 6 * seconds;
    // Adjust the seconds hand.
    //element.change("seconds hand", {degrees: degrees});
    seconds_hand.change({degrees: degrees})
    // every other second create or delete the blinking dot
    if ((seconds % 2) < 1) {
        if (!blinking_dot) {
            // Add the blinking dot.
            blinking_dot = element.circle({name: true, x:100, y:100, r:10, color:"red"});
        }
    } else if (blinking_dot) {
        // Remove the blinking dot.
        blinking_dot.forget();
        blinking_dot = null;
    }
    // Repeat the animation again on the next animation iteration.
    requestAnimationFrame(animate);
}
// Adjust the canvas coordinate transform to center the drawn objects on the canvas.
element.fit(null, 10);  // 10 pixel margin

// Add transitions
var bigger = false;
var transition_face = function() {
    var seconds = 10;
    if (bigger) {
        face.transition({r:100, color:"#dcf"}, seconds);
    } else {
        face.transition({r:30, color:"#fcd"}, seconds);
    }
    bigger = !bigger;
};
$("<button>transition face</button>").appendTo(element).click(transition_face);

// Adjust the canvas coordinate transform to center the drawn objects on the canvas.
element.fit(null, 10);  // 10 pixel margin

// Start the animation
animate();
        </textarea></div>
    
    </div>

<div id="discussion">
        <h3>Discussion</h3>
    
        <div>
            Objects drawn on a dual canvas can be modified or deleted if they have been given a unique name.
The illustration above modifies the object named "seconds hand" to animate the clock hand and
it deletes and recreates the object named "blinking dot" periodically.
        </div>
    
    </div>
    
    <script>
            var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
              lineNumbers: true,
              matchBrackets: true,
              continueComments: "Enter",
              extraKeys: {"Ctrl-Q": "toggleComment"}
            });
     </script>
            
</body>
</html>